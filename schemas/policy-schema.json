{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://raw.githubusercontent.com/go-nv/goenv/master/schemas/policy-schema.json",
  "title": "goenv SBOM Policy Schema",
  "description": "JSON Schema for goenv SBOM validation policies",
  "type": "object",
  "required": ["version", "rules"],
  "properties": {
    "version": {
      "type": "string",
      "description": "Policy schema version",
      "enum": ["1"]
    },
    "options": {
      "type": "object",
      "description": "Policy configuration options",
      "properties": {
        "fail_on_error": {
          "type": "boolean",
          "description": "Whether to fail validation when errors are detected",
          "default": true
        },
        "fail_on_warning": {
          "type": "boolean",
          "description": "Whether to fail validation when warnings are detected",
          "default": false
        },
        "verbose": {
          "type": "boolean",
          "description": "Enable verbose output",
          "default": false
        }
      }
    },
    "rules": {
      "type": "array",
      "description": "List of validation rules",
      "items": {
        "$ref": "#/definitions/rule"
      }
    }
  },
  "definitions": {
    "rule": {
      "type": "object",
      "required": ["name", "type", "severity", "check"],
      "properties": {
        "name": {
          "type": "string",
          "description": "Unique rule identifier",
          "pattern": "^[a-z0-9-]+$"
        },
        "type": {
          "type": "string",
          "description": "Rule category",
          "enum": ["supply-chain", "security", "completeness", "license"]
        },
        "severity": {
          "type": "string",
          "description": "Rule severity level",
          "enum": ["error", "warning", "info"]
        },
        "description": {
          "type": "string",
          "description": "Human-readable rule description"
        },
        "check": {
          "type": "string",
          "description": "Check type to perform",
          "enum": [
            "replace-directives",
            "vendoring-status",
            "retracted-versions",
            "cgo-disabled",
            "required-components",
            "required-metadata",
            "license-compliance",
            "unknown-licenses"
          ]
        },
        "blocked": {
          "type": "array",
          "description": "List of blocked values (for replace-directives, vendoring-status, license checks)",
          "items": {
            "type": "string"
          }
        },
        "required": {
          "type": "array",
          "description": "List of required values (for required-components, required-metadata, cgo-disabled checks)",
          "items": {
            "type": "string"
          }
        },
        "allowed": {
          "type": "array",
          "description": "List of allowed licenses (for license-compliance check)",
          "items": {
            "type": "string"
          }
        }
      }
    }
  }
}
